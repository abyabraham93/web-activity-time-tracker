var C=Object.defineProperty;var S=(a,e,t)=>e in a?C(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var f=(a,e,t)=>(S(a,typeof e!="symbol"?e+"":e,t),t);import"../browser-polyfill.js";import{a6 as y,b as T,S as v,o as E,a7 as L,W as R,i as b,a8 as I,B as A,g as P}from"../general.js";import{P as F}from"../PromoClearYouTube.js";import{d as O,h as N,r as i,j as V,c as D,a as s,t as c,u,p as K,e as M,o as w,_ as U,q as j,s as q}from"../i18n.js";class x{constructor(e,t){f(this,"domain");f(this,"time");this.domain=e,this.time=Date.now()+t*y}}async function $(a){const e=await T.getInstance().getSetting(v.BLOCK_DEFERRAL_TIME),t=e==null?void 0:e.find(n=>E(n.domain,a));return t!=null&&L(`Deferring time ${a} ${new Date(t.time)}`),t==null?!0:t!=null&&Date.now()-new Date(t.time).getTime()>R*24}async function W(a,e){const t=b(),n=await T.getInstance().getSetting(v.BLOCK_DEFERRAL_TIME),o=n==null?void 0:n.find(r=>E(r.domain,a));o!=null?o.time=Date.now()+e*y:n.push(new x(a,5)),await t.saveValue(v.BLOCK_DEFERRAL_TIME,n)}function H(a){const e=new URL(a),t=e.searchParams.get("domain"),n=e.searchParams.get("url"),o=e.searchParams.get("favicon"),r=Number(e.searchParams.get("summaryTime")),m=Number(e.searchParams.get("summaryCounter"));return{domain:t,url:n,limitTime:r,summaryCounter:m,favicon:o}}const Q={class:"block-container"},Y=["src"],z={class:"source-url"},G={class:"title"},J={class:"value"},X={class:"title"},Z={class:"value"},ee=["value"],te={class:"desctiption"},se=O({__name:"Block",setup(a){const{t:e}=N(),t=b(),n=i(),o=i(),r=i(),m=i(),p=i(),h=i(),_=i(),g=i();V(async()=>{const l=H(location.href);n.value=l.domain??"",o.value=l.url??"",r.value=l.limitTime,m.value=l.favicon??"",p.value=I(l.limitTime),h.value=l.summaryCounter??0,_.value=await t.getValue(v.BLOCK_DEFERRAL,A),g.value=await $(n.value)});async function B(){n.value!=null&&r.value!=null&&_.value&&g.value&&(await W(n.value,5),o.value!=""&&window.location.replace(o.value))}return(l,d)=>(w(),D("div",Q,[d[1]||(d[1]=s("div",{class:"header"},[s("img",{class:"d-inline-block",height:"40",src:P}),s("p",{class:"d-inline-block header"},"Web Activity Time Tracker")],-1)),s("p",null,c(u(e)("block.message")),1),s("div",null,[s("img",{class:"favicon",height:"35",src:m.value},null,8,Y),s("span",null,c(n.value),1)]),s("p",z,c(o.value),1),s("table",null,[s("tr",null,[s("td",G,c(u(e)("limit.message"))+":",1),s("td",J,c(p.value),1)]),s("tr",null,[s("td",X,c(u(e)("sessions.message"))+":",1),s("td",Z,c(h.value),1)])]),_.value&&g.value?(w(),D("input",{key:0,type:"button",class:"mt-20",value:u(e)("5mins.message"),onClick:d[0]||(d[0]=ne=>B())},null,8,ee)):K("",!0),s("p",te,c(u(e)("deferringDescription.message")),1),M(F)]))}});const ae=U(se,[["__scopeId","data-v-8f6e0f1e"]]),k=j(ae);k.use(q);k.mount("body");
