import{B as G}from"../browser-polyfill.js";import{r as le,t as re,c as ie,a as de,T as ue,S as p,_ as ce,i as N,C as _e,b as A,d as H,I as me,e as x,f as R,D as ve,g as pe}from"../general.js";import{a as ge,_ as ye,b as Te,B as fe,T as J,u as De,c as be,d as ke,F as Oe,e as Z,f as ee,s as te,g as j,h as q,i as Y,o as W,j as se,k as we,l as ae,m as he}from"../dark.js";import{d as F,r as w,o as u,c as D,a as e,n as oe,b as C,t as f,u as s,e as S,w as V,f as Re,g as Ee,v as Ie,T as Pe,_ as B,h as U,i as Se,j as K,k as $e,l as $,F as L,m as z,p as E,q as Ae,s as Me}from"../i18n.js";import{M as Ve}from"../messages.js";const Ce="/light-mode.svg",Fe="/dark-mode.svg",Be="/dashboard.svg",xe="/settings.svg";function M(b,a){le(2,arguments);var o=re(a);return ge(b,o*1e3)}const We={class:"expander"},Le={class:"d-inline-block"},Ne={class:"header"},Ue={class:"expander-body"},Ke={name:"Expander"},He=F({...Ke,props:{day:{},time:{}},setup(b){const a=w();return(o,i)=>(u(),D("div",We,[e("div",{class:oe(["expander-trigger",a.value?"active":"beforeBorder"]),onClick:i[0]||(i[0]=m=>a.value=!a.value)},[e("div",Le,[(u(),D("svg",{class:oe(["expander-trigger-Icon",{open:a.value}]),width:"40",height:"12",stroke:"cornflowerblue"},i[1]||(i[1]=[e("polyline",{points:"12,2 20,10 28,2","stroke-width":"3",fill:"none"},null,-1)]),2))]),e("div",Ne,[C(f(o.day)+" ",1),e("span",null,f(s(ie)(o.time)),1)])],2),S(Pe,{name:"leftToRight"},{default:V(()=>[Re(e("div",Ue,[Ee(o.$slots,"default",{},void 0,!0)],512),[[Ie,a.value]])]),_:3})]))}});const ne=B(He,[["__scopeId","data-v-677b5a4c"]]),je={key:0,class:"no-data"},qe={key:1},Ye={key:1},ze={class:"no-data"},Ge=["onClick"],Qe={key:2},Xe={class:"date-block"},Je=["onClick"],Ze=["value"],et={class:"stats-block block"},tt={class:"header"},st={class:"ml-20 mr-20 by-days-chart"},at={name:"TabList"},ot=F({...at,setup(b){const{t:a}=U(),o=w(),i=w(),m=w(),r=w(),g=de(),k=Se(()=>o.value!=null?o.value.days.length:0);async function y(T,d){const l=await De(T,d);l!=null&&(o.value=l,l.days.length==0&&l.summaryTime==0?m.value=!0:m.value=!1),i.value=!1}async function t(T){var n,v;r.value=T;const d=(n=r.value)==null?void 0:n[0],l=(v=r.value)==null?void 0:v[1];await y(d,l)}K(async()=>{var l,n;i.value=!0,r.value=ue;const T=(l=r.value)==null?void 0:l[0],d=(n=r.value)==null?void 0:n[1];await y(T,d)});async function c(){var n,v,_;const T=(n=r.value)==null?void 0:n[0],d=(v=r.value)==null?void 0:v[1],l=await be((_=o.value)==null?void 0:_.days);ke(l,Oe.CSV,`websites_${T.toLocaleDateString()}-${d.toLocaleDateString()}.csv`)}function P(T){if(!T)return[];const d=new Map;for(const l of T)for(const n of l.tabs){if(!d.has(n.url)){d.set(n.url,{...n});continue}const v=d.get(n.url);v.summaryTime+=n.summaryTime,v.sessions+=n.sessions}return Array.from(d.values()).sort((l,n)=>n.summaryTime-l.summaryTime)}return(T,d)=>{var n,v;const l=$e("VueDatePicker");return i.value?(u(),D("div",je,d[3]||(d[3]=[e("img",{height:"55",src:ye},null,-1)]))):(u(),D("div",qe,[k.value==null||k.value==0&&!m.value?(u(),$(Te,{key:0})):m.value?(u(),D("div",Ye,[e("div",ze,[C(f(s(a)("noDataForPeriod.message"))+" ",1),S(l,{range:"","enable-time-picker":!1,class:"date-picker",modelValue:r.value,"onUpdate:modelValue":[d[0]||(d[0]=_=>r.value=_),t],"preset-ranges":s(g)},{yearly:V(({label:_,range:O,presetDateRange:h})=>[e("span",{onClick:I=>h(O)},f(_),9,Ge)]),_:1},8,["modelValue","preset-ranges"])])])):(u(),D("div",Qe,[e("div",Xe,[S(l,{range:"","enable-time-picker":!1,class:"date-picker",modelValue:r.value,"onUpdate:modelValue":[d[1]||(d[1]=_=>r.value=_),t],"preset-ranges":s(g)},{yearly:V(({label:_,range:O,presetDateRange:h})=>[e("span",{onClick:I=>h(O)},f(_),9,Je)]),_:1},8,["modelValue","preset-ranges"]),e("input",{type:"button",value:s(a)("exportToCsv.message"),onClick:d[2]||(d[2]=_=>c())},null,8,Ze)]),e("div",et,[e("div",tt,f(s(a)("averageTimeByDays.message")),1),e("p",null,f(s(ie)(o.value.averageTime)),1)]),e("div",st,[S(fe,{data:o.value},null,8,["data"])]),e("div",null,[S(ne,{day:s(a)("allTime.message"),time:((n=o.value)==null?void 0:n.summaryTime)||0,class:"total"},{default:V(()=>{var _;return[(u(!0),D(L,null,z(P((_=o.value)==null?void 0:_.days),(O,h)=>{var I;return u(),$(J,{item:O,summaryTimeForWholeDay:((I=o.value)==null?void 0:I.summaryTime)||0},null,8,["item","summaryTimeForWholeDay"])}),256))]}),_:1},8,["day","time"]),(u(!0),D(L,null,z((v=o.value)==null?void 0:v.days,(_,O)=>(u(),$(ne,{key:O,day:_.day,time:_.time},{default:V(()=>[(u(!0),D(L,null,z(_.tabs,(h,I)=>(u(),$(J,{key:I,item:h,summaryTimeForWholeDay:_.time},null,8,["item","summaryTimeForWholeDay"]))),128))]),_:2},1032,["day","time"]))),128))])]))]))}}});const nt=B(ot,[["__scopeId","data-v-2129e53b"]]),it={key:0,class:"review-block"},lt=["value"],rt={name:"Review"},dt=F({...rt,setup(b){const{t:a}=U(),o=N(),i=12,m=2,r=5,g=w();K(async()=>{if(g.value=!1,await o.getValue(p.REVIEW_DATE)==null){let c=await o.getValue(p.REVIEW_PROMPT_AT);c==null?await o.saveValue(p.REVIEW_PROMPT_AT,Z(ee(te(),i),m).toString()):(c=new Date(c),c<new Date&&(g.value=!0))}});async function k(){g.value=!1,await o.saveValue(p.REVIEW_PROMPT_AT,Z(ee(te(),i),r).toString())}async function y(){window.open(_e,"_blank"),await o.saveValue(p.REVIEW_DATE,new Date().toString())}return(t,c)=>g.value?(u(),D("div",it,[e("p",null,f(s(a)("enjoyAndReview.message")),1),e("img",{height:"15",src:ce,onClick:c[0]||(c[0]=P=>k())}),e("input",{type:"button",value:s(a)("enjoyAndReview.description"),onClick:c[1]||(c[1]=P=>y())},null,8,lt)])):E("",!0)}});const ut=B(dt,[["__scopeId","data-v-ac21db1f"]]);async function ct(){const b="src/offscreen.html",a=G.runtime.getURL(b);await chrome.offscreen.hasDocument()||await chrome.offscreen.createDocument({url:a,reasons:["AUDIO_PLAYBACK"],justification:"Play audio sounds"})}async function _t(){let b;(l=>{l.work="WORK",l.rest="REST",l.finished="FINISH"})(b||(b={}));function a(l){let n;for(let v=1;v<=y;v++){let _=l=="WORK"?v-1:v;const O=g*_,h=(k+1)*(v-1),I=M(r,O+h);n=M(r,O+h+g);const X=t>=I&&(M(t,-1)<=n||t<=n);if(X)return{period:l,isTargetPeriod:X,isTargetPeriodFinishedNow:H(M(t,-1),n)||H(t,n)}}return{period:"FINISH",isTargetPeriod:!1,isTargetPeriodFinishedNow:!1}}async function o(l){function n(){switch(l){case"WORK":return p.POMODORO_AUDIO_AFTER_WORK;case"REST":return p.POMODORO_AUDIO_AFTER_REST;case"FINISH":return p.POMODORO_AUDIO_AFTER_FINISHED}}const v=await i.getValue(n());await ct(),await G.runtime.sendMessage({message:Ve.PlayAudio,sound:v,offscreen:!0})}const i=N();if(!await A.getInstance().getSetting(p.IS_POMODORO_ENABLED))return;const r=new Date(await A.getInstance().getSetting(p.POMODORO_START_TIME)),g=await A.getInstance().getSetting(p.POMODORO_INTERVAL_WORK),k=await A.getInstance().getSetting(p.POMODORO_INTERVAL_REST),y=await A.getInstance().getSetting(p.POMODORO_FREQUENCY),t=new Date,c=M(r,g*y+k*y),P=await G.tabs.query({active:!0});if(t>=c){H(t,c)&&await o("FINISH"),await i.saveValue(p.IS_POMODORO_ENABLED,!1),await i.saveValue(p.POMODORO_START_TIME,null),await j({tabId:P[0].id,text:null,color:q.none,icon:Y.default});return}let T=a("WORK");const d=T.isTargetPeriod;return d?await j({tabId:P[0].id,text:null,color:q.none,icon:Y.pomodoroWorkingTime}):(T=a("REST"),T.isTargetPeriod&&await j({tabId:P[0].id,text:null,color:q.none,icon:Y.pomodoroRestTime})),T.isTargetPeriodFinishedNow&&await o(T.period),{isWork:d}}const mt={key:0,class:"pomodoro-popup-block"},vt={key:0},pt={key:1},gt=["value"],yt={name:"PomodoroInfo"},Tt=F({...yt,setup(b){const{t:a}=U(),o=N(),i=w(),m=w();return K(async()=>{var r;i.value=await o.getValue(p.IS_POMODORO_ENABLED,me),m.value=(r=await _t())==null?void 0:r.isWork}),(r,g)=>i.value?(u(),D("div",mt,[e("p",null,f(s(a)("pomodoroIsEnabled.message")),1),m.value?(u(),D("span",vt,f(s(a)("pomodoroWork.message")),1)):E("",!0),m.value?E("",!0):(u(),D("span",pt,f(s(a)("pomodoroRest.message")),1)),e("input",{type:"button",value:s(a)("pomodoroSettings.message"),onClick:g[0]||(g[0]=k=>s(W)(s(x).Pomodoro))},null,8,gt)])):E("",!0)}});const ft=B(Tt,[["__scopeId","data-v-9dbdf296"]]),Dt={class:"headerBlock"},bt={class:"icons-block"},kt={class:"tabs"},Ot={title:"Today"},wt={for:"todayTab",role:"button"},ht={title:"All The Time"},Rt={for:"allTimeTab",role:"button"},Et={title:"By Days"},It={for:"byDaysTab",role:"button"},Pt={class:"content"},St={id:"todayTabList"},$t={id:"summary"},At={id:"byDaysTabList"},Mt=F({__name:"Popup",setup(b){const{t:a}=U(),o=N(),i=w(),m=w();K(async()=>{i.value=R.Today,m.value=await o.getValue(p.DARK_MODE,ve),m.value&&se(m.value)});function r(y){i.value=y}async function g(y){await o.saveValue(p.DARK_MODE,y),m.value=y,se(y),k()}function k(){const y=i.value;i.value=void 0,setTimeout(()=>{i.value=y},50)}return(y,t)=>(u(),D(L,null,[e("div",Dt,[t[11]||(t[11]=e("div",{class:"d-inline-block"},[e("img",{class:"logo",height:"30",src:pe}),e("p",{class:"header"},"Web Activity Time Tracker")],-1)),e("div",bt,[e("div",null,[m.value==!0?(u(),D("img",{key:0,class:"dark-mode-icon",height:"25",src:Ce,title:"Disable Dark Mode",onClick:t[0]||(t[0]=c=>g(!1))})):E("",!0),m.value==!1?(u(),D("img",{key:1,class:"dark-mode-icon",title:"Enable Dark Mode",height:"25",src:Fe,onClick:t[1]||(t[1]=c=>g(!0))})):E("",!0),e("a",{onClick:t[2]||(t[2]=c=>s(W)(s(x).Pomodoro))},[C(f(s(a)("pomodoroMode.message")),1),t[8]||(t[8]=e("img",{src:we,height:"22"},null,-1))]),e("a",{class:"filter",onClick:t[3]||(t[3]=c=>s(W)(s(x).Dashboard))},[C(f(s(a)("dashboard.message")),1),t[9]||(t[9]=e("img",{height:"22",src:Be},null,-1))]),e("a",{class:"filter",onClick:t[4]||(t[4]=c=>s(W)(s(x).GeneralSettings))},[C(f(s(a)("settings.message")),1),t[10]||(t[10]=e("img",{height:"22",src:xe},null,-1))])])])]),e("div",kt,[e("input",{type:"radio",id:"todayTab",name:"tab-control",checked:"",onChange:t[5]||(t[5]=c=>r(s(R).Today))},null,32),e("input",{type:"radio",id:"allTimeTab",name:"tab-control",onChange:t[6]||(t[6]=c=>r(s(R).All))},null,32),e("input",{type:"radio",id:"byDaysTab",name:"tab-control",onChange:t[7]||(t[7]=c=>r(s(R).ByDays))},null,32),e("ul",null,[e("li",Ot,[e("label",wt,[e("span",null,f(s(a)("today.message")),1)])]),e("li",ht,[e("label",Rt,[e("span",null,f(s(a)("allTime.message")),1)])]),e("li",Et,[e("label",It,[e("span",null,f(s(a)("byDays.message")),1)])])]),t[12]||(t[12]=e("div",{class:"slider"},[e("div",{class:"indicator"})],-1)),e("div",Pt,[e("section",St,[i.value==s(R).Today?(u(),$(ae,{key:0,type:s(R).Today,showAllStats:!1},null,8,["type"])):E("",!0)]),e("section",$t,[i.value==s(R).All?(u(),$(ae,{key:0,type:s(R).All,showAllStats:!0},null,8,["type"])):E("",!0)]),e("section",At,[i.value==s(R).ByDays?(u(),$(nt,{key:0})):E("",!0)])])]),S(ft),S(ut)],64))}});const Vt=B(Mt,[["__scopeId","data-v-11616b9c"]]),Q=Ae(Vt);Q.component("VueDatePicker",he);Q.use(Me);Q.mount("body");
