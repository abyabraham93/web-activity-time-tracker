import{B as G}from"../browser-polyfill.js";import{r as ie,t as le,c as re,a as ue,T as ce,S as p,_ as _e,i as N,C as me,b as A,d as H,I as ve,e as x,f as R,D as pe,g as ge}from"../general.js";import{a as de,s as ye,_ as Te,b as fe,B as De,T as J,u as be,c as ke,d as Oe,F as we,e as Z,f as j,g as q,h as Y,o as L,i as ee,j as he,k as te,l as Re}from"../dark.js";import{d as F,r as w,o as u,c as D,a as e,n as se,b as C,t as f,u as s,e as P,w as V,f as Ee,g as Ie,v as Se,T as Pe,_ as B,h as U,i as $e,j as K,k as Ae,l as $,F as W,m as z,p as E,q as Me,s as Ve}from"../i18n.js";import{M as Ce}from"../messages.js";const Fe="/light-mode.svg",Be="/dark-mode.svg",xe="/dashboard.svg",Le="/settings.svg";var We=36e5;function ae(b,a){ie(2,arguments);var o=le(a);return de(b,o*We)}function M(b,a){ie(2,arguments);var o=le(a);return de(b,o*1e3)}function oe(){return ye(Date.now())}const Ne={class:"expander"},Ue={class:"d-inline-block"},Ke={class:"header"},He={class:"expander-body"},je={name:"Expander"},qe=F({...je,props:{day:{},time:{}},setup(b){const a=w();return(o,i)=>(u(),D("div",Ne,[e("div",{class:se(["expander-trigger",a.value?"active":"beforeBorder"]),onClick:i[0]||(i[0]=m=>a.value=!a.value)},[e("div",Ue,[(u(),D("svg",{class:se(["expander-trigger-Icon",{open:a.value}]),width:"40",height:"12",stroke:"cornflowerblue"},i[1]||(i[1]=[e("polyline",{points:"12,2 20,10 28,2","stroke-width":"3",fill:"none"},null,-1)]),2))]),e("div",Ke,[C(f(o.day)+" ",1),e("span",null,f(s(re)(o.time)),1)])],2),P(Pe,{name:"leftToRight"},{default:V(()=>[Ee(e("div",He,[Ie(o.$slots,"default",{},void 0,!0)],512),[[Se,a.value]])]),_:3})]))}});const ne=B(qe,[["__scopeId","data-v-677b5a4c"]]),Ye={key:0,class:"no-data"},ze={key:1},Ge={key:1},Qe={class:"no-data"},Xe=["onClick"],Je={key:2},Ze={class:"date-block"},et=["onClick"],tt=["value"],st={class:"stats-block block"},at={class:"header"},ot={class:"ml-20 mr-20 by-days-chart"},nt={name:"TabList"},it=F({...nt,setup(b){const{t:a}=U(),o=w(),i=w(),m=w(),r=w(),g=ue(),k=$e(()=>o.value!=null?o.value.days.length:0);async function y(T,d){const l=await be(T,d);l!=null&&(o.value=l,l.days.length==0&&l.summaryTime==0?m.value=!0:m.value=!1),i.value=!1}async function t(T){var n,v;r.value=T;const d=(n=r.value)==null?void 0:n[0],l=(v=r.value)==null?void 0:v[1];await y(d,l)}K(async()=>{var l,n;i.value=!0,r.value=ce;const T=(l=r.value)==null?void 0:l[0],d=(n=r.value)==null?void 0:n[1];await y(T,d)});async function c(){var n,v,_;const T=(n=r.value)==null?void 0:n[0],d=(v=r.value)==null?void 0:v[1],l=await ke((_=o.value)==null?void 0:_.days);Oe(l,we.CSV,`websites_${T.toLocaleDateString()}-${d.toLocaleDateString()}.csv`)}function S(T){if(!T)return[];const d=new Map;for(const l of T)for(const n of l.tabs){if(!d.has(n.url)){d.set(n.url,{...n});continue}const v=d.get(n.url);v.summaryTime+=n.summaryTime,v.sessions+=n.sessions}return Array.from(d.values()).sort((l,n)=>n.summaryTime-l.summaryTime)}return(T,d)=>{var n,v;const l=Ae("VueDatePicker");return i.value?(u(),D("div",Ye,d[3]||(d[3]=[e("img",{height:"55",src:Te},null,-1)]))):(u(),D("div",ze,[k.value==null||k.value==0&&!m.value?(u(),$(fe,{key:0})):m.value?(u(),D("div",Ge,[e("div",Qe,[C(f(s(a)("noDataForPeriod.message"))+" ",1),P(l,{range:"","enable-time-picker":!1,class:"date-picker",modelValue:r.value,"onUpdate:modelValue":[d[0]||(d[0]=_=>r.value=_),t],"preset-ranges":s(g)},{yearly:V(({label:_,range:O,presetDateRange:h})=>[e("span",{onClick:I=>h(O)},f(_),9,Xe)]),_:1},8,["modelValue","preset-ranges"])])])):(u(),D("div",Je,[e("div",Ze,[P(l,{range:"","enable-time-picker":!1,class:"date-picker",modelValue:r.value,"onUpdate:modelValue":[d[1]||(d[1]=_=>r.value=_),t],"preset-ranges":s(g)},{yearly:V(({label:_,range:O,presetDateRange:h})=>[e("span",{onClick:I=>h(O)},f(_),9,et)]),_:1},8,["modelValue","preset-ranges"]),e("input",{type:"button",value:s(a)("exportToCsv.message"),onClick:d[2]||(d[2]=_=>c())},null,8,tt)]),e("div",st,[e("div",at,f(s(a)("averageTimeByDays.message")),1),e("p",null,f(s(re)(o.value.averageTime)),1)]),e("div",ot,[P(De,{data:o.value},null,8,["data"])]),e("div",null,[P(ne,{day:s(a)("allTime.message"),time:((n=o.value)==null?void 0:n.summaryTime)||0,class:"total"},{default:V(()=>{var _;return[(u(!0),D(W,null,z(S((_=o.value)==null?void 0:_.days),(O,h)=>{var I;return u(),$(J,{item:O,summaryTimeForWholeDay:((I=o.value)==null?void 0:I.summaryTime)||0},null,8,["item","summaryTimeForWholeDay"])}),256))]}),_:1},8,["day","time"]),(u(!0),D(W,null,z((v=o.value)==null?void 0:v.days,(_,O)=>(u(),$(ne,{key:O,day:_.day,time:_.time},{default:V(()=>[(u(!0),D(W,null,z(_.tabs,(h,I)=>(u(),$(J,{key:I,item:h,summaryTimeForWholeDay:_.time},null,8,["item","summaryTimeForWholeDay"]))),128))]),_:2},1032,["day","time"]))),128))])]))]))}}});const lt=B(it,[["__scopeId","data-v-2129e53b"]]),rt={key:0,class:"review-block"},dt=["value"],ut={name:"Review"},ct=F({...ut,setup(b){const{t:a}=U(),o=N(),i=12,m=2,r=5,g=w();K(async()=>{if(g.value=!1,await o.getValue(p.REVIEW_DATE)==null){let c=await o.getValue(p.REVIEW_PROMPT_AT);c==null?await o.saveValue(p.REVIEW_PROMPT_AT,Z(ae(oe(),i),m).toString()):(c=new Date(c),c<new Date&&(g.value=!0))}});async function k(){g.value=!1,await o.saveValue(p.REVIEW_PROMPT_AT,Z(ae(oe(),i),r).toString())}async function y(){window.open(me,"_blank"),await o.saveValue(p.REVIEW_DATE,new Date().toString())}return(t,c)=>g.value?(u(),D("div",rt,[e("p",null,f(s(a)("enjoyAndReview.message")),1),e("img",{height:"15",src:_e,onClick:c[0]||(c[0]=S=>k())}),e("input",{type:"button",value:s(a)("enjoyAndReview.description"),onClick:c[1]||(c[1]=S=>y())},null,8,dt)])):E("",!0)}});const _t=B(ct,[["__scopeId","data-v-ac21db1f"]]);async function mt(){const b="src/offscreen.html",a=G.runtime.getURL(b);await chrome.offscreen.hasDocument()||await chrome.offscreen.createDocument({url:a,reasons:["AUDIO_PLAYBACK"],justification:"Play audio sounds"})}async function vt(){let b;(l=>{l.work="WORK",l.rest="REST",l.finished="FINISH"})(b||(b={}));function a(l){let n;for(let v=1;v<=y;v++){let _=l=="WORK"?v-1:v;const O=g*_,h=(k+1)*(v-1),I=M(r,O+h);n=M(r,O+h+g);const X=t>=I&&(M(t,-1)<=n||t<=n);if(X)return{period:l,isTargetPeriod:X,isTargetPeriodFinishedNow:H(M(t,-1),n)||H(t,n)}}return{period:"FINISH",isTargetPeriod:!1,isTargetPeriodFinishedNow:!1}}async function o(l){function n(){switch(l){case"WORK":return p.POMODORO_AUDIO_AFTER_WORK;case"REST":return p.POMODORO_AUDIO_AFTER_REST;case"FINISH":return p.POMODORO_AUDIO_AFTER_FINISHED}}const v=await i.getValue(n());await mt(),await G.runtime.sendMessage({message:Ce.PlayAudio,sound:v,offscreen:!0})}const i=N();if(!await A.getInstance().getSetting(p.IS_POMODORO_ENABLED))return;const r=new Date(await A.getInstance().getSetting(p.POMODORO_START_TIME)),g=await A.getInstance().getSetting(p.POMODORO_INTERVAL_WORK),k=await A.getInstance().getSetting(p.POMODORO_INTERVAL_REST),y=await A.getInstance().getSetting(p.POMODORO_FREQUENCY),t=new Date,c=M(r,g*y+k*y),S=await G.tabs.query({active:!0});if(t>=c){H(t,c)&&await o("FINISH"),await i.saveValue(p.IS_POMODORO_ENABLED,!1),await i.saveValue(p.POMODORO_START_TIME,null),await j({tabId:S[0].id,text:null,color:q.none,icon:Y.default});return}let T=a("WORK");const d=T.isTargetPeriod;return d?await j({tabId:S[0].id,text:null,color:q.none,icon:Y.pomodoroWorkingTime}):(T=a("REST"),T.isTargetPeriod&&await j({tabId:S[0].id,text:null,color:q.none,icon:Y.pomodoroRestTime})),T.isTargetPeriodFinishedNow&&await o(T.period),{isWork:d}}const pt={key:0,class:"pomodoro-popup-block"},gt={key:0},yt={key:1},Tt=["value"],ft={name:"PomodoroInfo"},Dt=F({...ft,setup(b){const{t:a}=U(),o=N(),i=w(),m=w();return K(async()=>{var r;i.value=await o.getValue(p.IS_POMODORO_ENABLED,ve),m.value=(r=await vt())==null?void 0:r.isWork}),(r,g)=>i.value?(u(),D("div",pt,[e("p",null,f(s(a)("pomodoroIsEnabled.message")),1),m.value?(u(),D("span",gt,f(s(a)("pomodoroWork.message")),1)):E("",!0),m.value?E("",!0):(u(),D("span",yt,f(s(a)("pomodoroRest.message")),1)),e("input",{type:"button",value:s(a)("pomodoroSettings.message"),onClick:g[0]||(g[0]=k=>s(L)(s(x).Pomodoro))},null,8,Tt)])):E("",!0)}});const bt=B(Dt,[["__scopeId","data-v-9dbdf296"]]),kt={class:"headerBlock"},Ot={class:"icons-block"},wt={class:"tabs"},ht={title:"Today"},Rt={for:"todayTab",role:"button"},Et={title:"All The Time"},It={for:"allTimeTab",role:"button"},St={title:"By Days"},Pt={for:"byDaysTab",role:"button"},$t={class:"content"},At={id:"todayTabList"},Mt={id:"summary"},Vt={id:"byDaysTabList"},Ct=F({__name:"Popup",setup(b){const{t:a}=U(),o=N(),i=w(),m=w();K(async()=>{i.value=R.Today,m.value=await o.getValue(p.DARK_MODE,pe),m.value&&ee(m.value)});function r(y){i.value=y}async function g(y){await o.saveValue(p.DARK_MODE,y),m.value=y,ee(y),k()}function k(){const y=i.value;i.value=void 0,setTimeout(()=>{i.value=y},50)}return(y,t)=>(u(),D(W,null,[e("div",kt,[t[11]||(t[11]=e("div",{class:"d-inline-block"},[e("img",{class:"logo",height:"30",src:ge}),e("p",{class:"header"},"Web Activity Time Tracker")],-1)),e("div",Ot,[e("div",null,[m.value==!0?(u(),D("img",{key:0,class:"dark-mode-icon",height:"25",src:Fe,title:"Disable Dark Mode",onClick:t[0]||(t[0]=c=>g(!1))})):E("",!0),m.value==!1?(u(),D("img",{key:1,class:"dark-mode-icon",title:"Enable Dark Mode",height:"25",src:Be,onClick:t[1]||(t[1]=c=>g(!0))})):E("",!0),e("a",{onClick:t[2]||(t[2]=c=>s(L)(s(x).Pomodoro))},[C(f(s(a)("pomodoroMode.message")),1),t[8]||(t[8]=e("img",{src:he,height:"22"},null,-1))]),e("a",{class:"filter",onClick:t[3]||(t[3]=c=>s(L)(s(x).Dashboard))},[C(f(s(a)("dashboard.message")),1),t[9]||(t[9]=e("img",{height:"22",src:xe},null,-1))]),e("a",{class:"filter",onClick:t[4]||(t[4]=c=>s(L)(s(x).GeneralSettings))},[C(f(s(a)("settings.message")),1),t[10]||(t[10]=e("img",{height:"22",src:Le},null,-1))])])])]),e("div",wt,[e("input",{type:"radio",id:"todayTab",name:"tab-control",checked:"",onChange:t[5]||(t[5]=c=>r(s(R).Today))},null,32),e("input",{type:"radio",id:"allTimeTab",name:"tab-control",onChange:t[6]||(t[6]=c=>r(s(R).All))},null,32),e("input",{type:"radio",id:"byDaysTab",name:"tab-control",onChange:t[7]||(t[7]=c=>r(s(R).ByDays))},null,32),e("ul",null,[e("li",ht,[e("label",Rt,[e("span",null,f(s(a)("today.message")),1)])]),e("li",Et,[e("label",It,[e("span",null,f(s(a)("allTime.message")),1)])]),e("li",St,[e("label",Pt,[e("span",null,f(s(a)("byDays.message")),1)])])]),t[12]||(t[12]=e("div",{class:"slider"},[e("div",{class:"indicator"})],-1)),e("div",$t,[e("section",At,[i.value==s(R).Today?(u(),$(te,{key:0,type:s(R).Today,showAllStats:!1},null,8,["type"])):E("",!0)]),e("section",Mt,[i.value==s(R).All?(u(),$(te,{key:0,type:s(R).All,showAllStats:!0},null,8,["type"])):E("",!0)]),e("section",Vt,[i.value==s(R).ByDays?(u(),$(lt,{key:0})):E("",!0)])])]),P(bt),P(_t)],64))}});const Ft=B(Ct,[["__scopeId","data-v-11616b9c"]]),Q=Me(Ft);Q.component("VueDatePicker",Re);Q.use(Ve);Q.mount("body");
